# ğŸ“¦ QuantaIV ç³»çµ±é–‹ç™¼æ–‡ä»¶ï¼šå®Œæ•´ç‰ˆæœ¬åŒ–å·¥ä½œæµç¨‹ (M1-M7)

---

## ğŸ¯ ç³»çµ±æ¦‚è¿°

QuantaIV æ˜¯ä¸€å€‹å®Œæ•´çš„é‡åŒ–äº¤æ˜“ç³»çµ±ï¼Œå…·å‚™ç‰ˆæœ¬åŒ–ç®¡ç†åŠŸèƒ½ï¼Œæ”¯æ´å¾åƒæ•¸ç”Ÿæˆåˆ°æ¨¡æ“¬äº¤æ˜“çš„å®Œæ•´å·¥ä½œæµç¨‹ã€‚ç³»çµ±æ¡ç”¨æ™‚é–“æˆ³ç‰ˆæœ¬åŒ–ç›®éŒ„ï¼Œç¢ºä¿å¤šæ¬¡æ¸¬è©¦å’Œé©—è­‰ä¸æœƒç›¸äº’å¹²æ“¾ã€‚

### ğŸ”„ å®Œæ•´å·¥ä½œæµç¨‹
1. **M1** - åƒæ•¸ç”Ÿæˆæ¨¡çµ„
2. **M2** - æ¨£æœ¬å…§å›æ¸¬ (è¨Šè™Ÿ+ç¸¾æ•ˆ)
3. **M3** - æ¨£æœ¬å…§ç­–ç•¥æŒ‘é¸
4. **M4/M5** - æ¨£æœ¬å¤–é©—è­‰ (è¨Šè™Ÿ+ç¸¾æ•ˆ+æŒ‘é¸)
5. **M6** - ç”¢ç”Ÿæ¨¡æ“¬äº¤æ˜“è¨Šè™Ÿ
6. **M7** - æ¨¡æ“¬æ¯æ—¥ç¸¾æ•ˆ

---

## ğŸ“ ç‰ˆæœ¬åŒ–ç³»çµ±æ¶æ§‹

### ç‰ˆæœ¬ç®¡ç†
- **ç‰ˆæœ¬æ ¼å¼**: `YYYYMMDD_HHMMSS` (ä¾‹å¦‚: `20250628_150457`)
- **ç‰ˆæœ¬ç®¡ç†å™¨**: `utils/version_manager.py`
- **å…ƒæ•¸æ“šæª”æ¡ˆ**: `version_metadata.json`

### ç›®éŒ„çµæ§‹
```
QuantaIV/
â”œâ”€â”€ strategies/
â”‚   â”œâ”€â”€ in_sample/
â”‚   â”‚   â”œâ”€â”€ all_params/{version}/
â”‚   â”‚   â””â”€â”€ best/{version}/
â”‚   â””â”€â”€ out_sample/
â”‚       â”œâ”€â”€ param_logs/{version}/
â”‚       â””â”€â”€ best/{version}/
â”œâ”€â”€ trading_simulation/
â”‚   â”œâ”€â”€ signal/{version}/
â”‚   â””â”€â”€ performance/{version}/
â””â”€â”€ version_metadata.json
```

---

## ğŸ§© æ¨¡çµ„åç¨±ï¼šM6_æ¨¡æ“¬ä¸‹å–®è¨Šè™Ÿç”¢ç”Ÿå™¨

### 1. åŠŸèƒ½èªªæ˜
M6 æ¨¡çµ„å¾æ¨£æœ¬å¤–é©—è­‰éšæ®µé¸å‡ºçš„æœ€ä½³ç­–ç•¥ä¸­ï¼Œç¯©é¸æ¯æ”¯è‚¡ç¥¨çš„å¤šçµ„æœ€ä½³åƒæ•¸ï¼Œæ ¹æ“šæœ€æ–°åƒ¹æ ¼è¨ˆç®—æ˜¯å¦ç”¢ç”Ÿä¸‹å–®è¨Šè™Ÿï¼ˆbuy: 1, hold: 0, sell: -1ï¼‰ï¼Œä¸¦å°‡çµæœå„²å­˜ç‚ºæ¨¡æ“¬äº¤æ˜“ç´€éŒ„ã€‚

### 2. ä¸»æ§é¸å–®è¼¸å…¥é …ç›®
- **è‚¡ç¥¨ä»£ç¢¼**: ç”¨é€—è™Ÿåˆ†éš” (ä¾‹å¦‚: `TSLA,AAPL,NVDA`)
- **è‡ªå‹•è®€å–**: å¾ç‰ˆæœ¬åŒ–ç›®éŒ„ `/strategies/out_sample/best/{version}/` ä¸­è®€å–æœ€ä½³ç­–ç•¥
- **è‡ªå‹•è®€å–**: å¾è³‡æ–™åº«è®€å–æœ€æ–°åƒ¹æ ¼è³‡è¨Š

### 3. åŸ·è¡Œä¸­èˆ‡çµæŸæ™‚ç•«é¢
```
ã€M6 - ç”¢ç”Ÿæ¨¡æ“¬äº¤æ˜“è¨Šè™Ÿã€‘
è«‹è¼¸å…¥è¦ç”¢ç”Ÿè¨Šè™Ÿçš„è‚¡ç¥¨ä»£ç¢¼ï¼Œç”¨é€—è™Ÿåˆ†éš” (ä¾‹å¦‚: AAPL,NVDA): TSLA
M6 - Generating Simulated Trading Signals...
Processing symbol: TSLA
INFO: Finding best strategies for TSLA...
  - Loaded 5 strategies from best_strategies_TSLA_RSI_signals_all_params_20250628_153108_validation_validation.csv
  -> Strategy: RSI, Param_ID: RSI_d782c59a_20250628_151311, Signal: 0, Price: 323.63
  -> Strategy: RSI, Param_ID: RSI_37f6cd0a_20250628_151311, Signal: 0, Price: 323.63
  ...

SUCCESS: M6 process complete. Trade decisions saved to:
trading_simulation/signal/20250628_150457\M6_trade_decisions_20250628.csv
ğŸ“‚ ç‰ˆæœ¬ç›®éŒ„: 20250628_150457
```

### 4. è®€å–è³‡æ–™ä¾†æºèˆ‡æ¬„ä½
- **ç­–ç•¥æ¸…å–®æª”æ¡ˆ**: `/strategies/out_sample/best/{version}/best_strategies_*_{symbol}_*.csv`
  - æ¬„ä½: `param_id`, `total_return`, `max_drawdown`, `sharpe`
- **åƒæ•¸è©³ç´°è¨­å®š**: `/strategies/out_sample/param_logs/{version}/param_log_{strategy_type}_{symbol}.json`
- **åƒ¹æ ¼è³‡æ–™**: SQLite è³‡æ–™åº« (æ¬„ä½: `date`, `symbol`, `close`, `volume`...)

### 5. è¼¸å‡ºå„²å­˜å®šç¾©
- **å„²å­˜è·¯å¾‘**: `/trading_simulation/signal/{version}/`
- **æª”åæ ¼å¼**: `M6_trade_decisions_YYYYMMDD.csv`
- **æ¬„ä½**: `date`, `symbol`, `strategy_type`, `param_id`, `signal`, `price`, `comment`

---

## ğŸ§© æ¨¡çµ„åç¨±ï¼šM7_æ¨¡æ“¬è³‡é‡‘è¿½è¹¤ç¸¾æ•ˆæ¨¡çµ„

### 1. åŠŸèƒ½èªªæ˜
M7 æ¨¡çµ„æ¨¡æ“¬æ¯æ—¥ä¾æ“š M6 çš„äº¤æ˜“è¨Šè™Ÿé€²è¡Œè³‡é‡‘èª¿æ•´èˆ‡æŒå€‰ç®¡ç†ã€‚æ¯å€‹ç­–ç•¥åƒæ•¸çµ„åˆéƒ½æœ‰ç¨ç«‹çš„è™›æ“¬å¸³æˆ¶ï¼Œè¨ˆç®—ç´¯ç©å ±é…¬ã€ç¾é‡‘ã€æŒå€‰ã€æ·¨å€¼ç­‰æŒ‡æ¨™ã€‚

### 2. ä¸»æ§é¸å–®è¼¸å…¥é …ç›®
- âŒ **ç„¡éœ€è¼¸å…¥**ï¼Œæ ¹æ“š M6 è¼¸å‡ºè‡ªå‹•åŸ·è¡Œ
- **è‡ªå‹•è®€å–**: å¾ç‰ˆæœ¬åŒ–ç›®éŒ„è®€å– M6 è¨Šè™Ÿæª”æ¡ˆ
- **è‡ªå‹•è®€å–**: å¾å‰ä¸€æ—¥ç¸¾æ•ˆå¿«ç…§æ¢å¾©å¸³æˆ¶ç‹€æ…‹

### 3. åŸ·è¡Œä¸­èˆ‡çµæŸæ™‚ç•«é¢
```
ã€M7 - æ¨¡æ“¬æ¯æ—¥ç¸¾æ•ˆã€‘

M7 - Simulating Daily Multi-Strategy Performance...
INFO: Loaded 5 trade signals for 2025-06-28.
INFO: No snapshot from yesterday found. Starting with fresh accounts.

SUCCESS: M7 process complete. 5 accounts simulated.
Today's performance snapshot saved to:
trading_simulation/performance/20250628_150457\M7_simulation_result_20250628.csv
ğŸ“‚ ç‰ˆæœ¬ç›®éŒ„: 20250628_150457

--- Simulation Summary ---
Total simulated strategies: 5
Total simulated asset value: $500,000.00
--------------------------
```

### 4. è®€å–è³‡æ–™ä¾†æºèˆ‡æ¬„ä½
- **M6 è¼¸å‡ºæª”æ¡ˆ**: `/trading_simulation/signal/{version}/M6_trade_decisions_YYYYMMDD.csv`
- **å‰æ—¥ç¸¾æ•ˆå¿«ç…§**: `/trading_simulation/performance/{version}/M7_simulation_result_YYYYMMDD.csv`
- **åˆå§‹è³‡é‡‘**: `utils/config.py` ä¸­çš„ `INITIAL_CAPITAL`

### 5. è¼¸å‡ºå„²å­˜å®šç¾©
- **å„²å­˜è·¯å¾‘**: `/trading_simulation/performance/{version}/`
- **æª”æ¡ˆåç¨±**: `M7_simulation_result_YYYYMMDD.csv`
- **æ¬„ä½**: `param_id`, `cash`, `position_size`, `position_value`, `total_value`, `last_updated`

---

## ğŸ”§ ç‰ˆæœ¬åŒ–ç³»çµ±æ ¸å¿ƒåŠŸèƒ½

### VersionManager é¡åˆ¥
```python
class VersionManager:
    def create_new_version(self) -> str
    def get_current_version(self) -> Optional[str]
    def get_version_path(self, version_id: str, path_type: str) -> str
    def list_versions(self) -> List[Dict]
```

### æ”¯æ´çš„ç‰ˆæœ¬è·¯å¾‘é¡å‹
- `in_sample_params`: æ¨£æœ¬å…§åƒæ•¸ç›®éŒ„
- `in_sample_best`: æ¨£æœ¬å…§æœ€ä½³ç­–ç•¥ç›®éŒ„
- `out_sample_params`: æ¨£æœ¬å¤–åƒæ•¸ç›®éŒ„
- `out_sample_best`: æ¨£æœ¬å¤–æœ€ä½³ç­–ç•¥ç›®éŒ„
- `trading_signal`: æ¨¡æ“¬äº¤æ˜“è¨Šè™Ÿç›®éŒ„
- `trading_performance`: æ¨¡æ“¬äº¤æ˜“ç¸¾æ•ˆç›®éŒ„

---

## ğŸ“Š åƒæ•¸ ID æ ¼å¼

### æ™‚é–“æˆ³æ ¼å¼
- **æ ¼å¼**: `{strategy_type}_{hash}_{timestamp}`
- **ç¯„ä¾‹**: `RSI_d782c59a_20250628_151311`
- **èªªæ˜**: ç¢ºä¿åƒæ•¸å”¯ä¸€æ€§ï¼Œé¿å…è·¨ç‰ˆæœ¬è¡çª

---

## ğŸš€ ä½¿ç”¨ç¯„ä¾‹

### å®Œæ•´å·¥ä½œæµç¨‹åŸ·è¡Œ
1. **M1**: ç”Ÿæˆåƒæ•¸ â†’ å»ºç«‹æ–°ç‰ˆæœ¬ç›®éŒ„
2. **M2**: æ¨£æœ¬å…§å›æ¸¬ â†’ ç‰ˆæœ¬åŒ–è¨Šè™Ÿå’Œç¸¾æ•ˆ
3. **M3**: ç­–ç•¥æŒ‘é¸ â†’ ç‰ˆæœ¬åŒ–æœ€ä½³ç­–ç•¥
4. **M4/M5**: æ¨£æœ¬å¤–é©—è­‰ â†’ ç‰ˆæœ¬åŒ–é©—è­‰çµæœ
5. **M6**: æ¨¡æ“¬è¨Šè™Ÿ â†’ ç‰ˆæœ¬åŒ–äº¤æ˜“æ±ºç­–
6. **M7**: ç¸¾æ•ˆè¿½è¹¤ â†’ ç‰ˆæœ¬åŒ–å¸³æˆ¶å¿«ç…§

### ç‰ˆæœ¬ç®¡ç†æ“ä½œ
```python
from utils.version_manager import version_manager

# å»ºç«‹æ–°ç‰ˆæœ¬
new_version = version_manager.create_new_version()

# å–å¾—ç•¶å‰ç‰ˆæœ¬
current_version = version_manager.get_current_version()

# å–å¾—ç‰ˆæœ¬è·¯å¾‘
best_strategies_path = version_manager.get_version_path(current_version, "out_sample_best")
```

---

## ğŸ“Œ é‡è¦å‚™è¨»

### ç‰ˆæœ¬åŒ–å„ªå‹¢
- âœ… **é¿å…æª”æ¡ˆè¦†è“‹**: æ¯æ¬¡åŸ·è¡Œéƒ½åœ¨ç¨ç«‹ç‰ˆæœ¬ç›®éŒ„
- âœ… **åƒæ•¸å”¯ä¸€æ€§**: param_id åŒ…å«æ™‚é–“æˆ³ï¼Œç¢ºä¿å”¯ä¸€æ€§
- âœ… **å®Œæ•´è¿½è¹¤**: å¾ M1 åˆ° M7 çš„å®Œæ•´å·¥ä½œæµç¨‹éƒ½æœ‰ç‰ˆæœ¬è¨˜éŒ„
- âœ… **æ¸…æ™°çµ„ç¹”**: æª”æ¡ˆçµæ§‹æ¸…æ™°ï¼Œæ˜“æ–¼ç®¡ç†å’ŒæŸ¥æ‰¾

### ç³»çµ±é™åˆ¶
- âš ï¸ **ç£ç¢Ÿç©ºé–“**: ç‰ˆæœ¬åŒ–æœƒä½”ç”¨æ›´å¤šç£ç¢Ÿç©ºé–“
- âš ï¸ **ç‰ˆæœ¬ç®¡ç†**: éœ€è¦å®šæœŸæ¸…ç†èˆŠç‰ˆæœ¬ä»¥ç¯€çœç©ºé–“

### æœªä¾†æ“´å±•
- ğŸ”® **ç‰ˆæœ¬æ¯”è¼ƒ**: è·¨ç‰ˆæœ¬ç¸¾æ•ˆæ¯”è¼ƒåŠŸèƒ½
- ğŸ”® **è‡ªå‹•æ¸…ç†**: è‡ªå‹•æ¸…ç†éæœŸç‰ˆæœ¬
- ğŸ”® **ç‰ˆæœ¬æ¨™ç±¤**: ç‚ºé‡è¦ç‰ˆæœ¬æ·»åŠ æ¨™ç±¤å’Œè¨»è§£
